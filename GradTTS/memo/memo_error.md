Synthesis...
  0%|          | 0/322 [00:00<?, ?it/s]tensor([-0.1669,  0.0000,  0.1250], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 0 | dur_loss: 0.5313811898231506, prior_loss: 13.151346206665039, diff_loss: 1.0842866897583008:   0%|          | 1/322 [00:01<07:31,  1.41s/it]tensor([-0.1607,  0.0000,  0.3396], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 1 | dur_loss: 0.47623303532600403, prior_loss: 13.180610656738281, diff_loss: 1.145982265472412:   1%|          | 2/322 [00:02<06:06,  1.15s/it]tensor([-0.0910,  0.0000,  0.1886], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 2 | dur_loss: 4.6722540855407715, prior_loss: 12.171858787536621, diff_loss: 1.0293182134628296:   1%|          | 3/322 [00:03<05:36,  1.05s/it]tensor([-0.0727,  0.0000,  0.1013], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 3 | dur_loss: 5.4974870681762695, prior_loss: 12.492551803588867, diff_loss: 0.9780493378639221:   1%|          | 4/322 [00:04<05:21,  1.01s/it]tensor([-0.1045,  0.0000,  0.0735], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 4 | dur_loss: 0.48551812767982483, prior_loss: 12.554667472839355, diff_loss: 0.9552404284477234:   2%|▏         | 5/322 [00:05<05:14,  1.01it/s]tensor([-0.0966,  0.0000,  0.1016], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 5 | dur_loss: 0.4819246828556061, prior_loss: 12.34876823425293, diff_loss: 0.9316479563713074:   2%|▏         | 6/322 [00:06<05:10,  1.02it/s]tensor([-0.0575,  0.0000,  0.1157], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 6 | dur_loss: 4.817166805267334, prior_loss: 12.526630401611328, diff_loss: 0.9053035378456116:   2%|▏         | 7/322 [00:07<05:06,  1.03it/s]tensor([-0.0680,  0.0000,  0.1436], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 7 | dur_loss: 0.4137798249721527, prior_loss: 12.409568786621094, diff_loss: 0.8657065629959106:   2%|▏         | 8/322 [00:08<05:05,  1.03it/s]tensor([-0.1117,  0.0000,  0.1548], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 8 | dur_loss: 4.916354179382324, prior_loss: 11.52802848815918, diff_loss: 0.8133276104927063:   3%|▎         | 9/322 [00:09<05:03,  1.03it/s]tensor([-0.1562,  0.0000,  0.1772], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 9 | dur_loss: 0.38036370277404785, prior_loss: 12.121441841125488, diff_loss: 0.7718675136566162:   3%|▎         | 10/322 [00:10<05:00,  1.04it/s]tensor([-0.1884,  0.0000,  0.1927], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 10 | dur_loss: 0.36066511273384094, prior_loss: 11.14072322845459, diff_loss: 0.7267758250236511:   3%|▎         | 11/322 [00:10<04:59,  1.04it/s]tensor([-0.2326,  0.0000,  0.2376], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 11 | dur_loss: 0.3545408546924591, prior_loss: 11.506157875061035, diff_loss: 0.6872670650482178:   4%|▎         | 12/322 [00:11<05:02,  1.03it/s]tensor([-0.2474,  0.0000,  0.2376], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 12 | dur_loss: 0.37411728501319885, prior_loss: 11.17304801940918, diff_loss: 0.6347540616989136:   4%|▍         | 13/322 [00:12<05:00,  1.03it/s]tensor([-0.3038,  0.0000,  0.2638], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 13 | dur_loss: 0.33696433901786804, prior_loss: 10.893050193786621, diff_loss: 0.5946420431137085:   4%|▍         | 14/322 [00:14<05:07,  1.00it/s]tensor([-0.3215,  0.0000,  0.2880], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 14 | dur_loss: 0.3571447730064392, prior_loss: 11.137255668640137, diff_loss: 0.5518844127655029:   5%|▍         | 15/322 [00:15<05:20,  1.04s/it]tensor([-0.3297,  0.0000,  0.3103], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 15 | dur_loss: 0.3197591006755829, prior_loss: 10.250744819641113, diff_loss: 0.5519503951072693:   5%|▍         | 16/322 [00:16<05:23,  1.06s/it]tensor([-0.3434,  0.0000,  0.3570], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 16 | dur_loss: 0.3669278621673584, prior_loss: 10.269082069396973, diff_loss: 0.5428626537322998:   5%|▌         | 17/322 [00:17<05:20,  1.05s/it]tensor([-0.4007,  0.0000,  0.3921], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 17 | dur_loss: 4.2650980949401855, prior_loss: 10.990656852722168, diff_loss: 0.4573625326156616:   6%|▌         | 18/322 [00:18<05:28,  1.08s/it]tensor([-0.4231,  0.0000,  0.3963], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 18 | dur_loss: 0.35924574732780457, prior_loss: 10.373208045959473, diff_loss: 0.45902398228645325:   6%|▌         | 19/322 [00:19<05:18,  1.05s/it]tensor([-0.3806,  0.0000,  0.3949], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 19 | dur_loss: 0.3314272165298462, prior_loss: 10.210549354553223, diff_loss: 0.476870059967041:   6%|▌         | 20/322 [00:20<05:10,  1.03s/it]tensor([-0.4511,  0.0000,  0.4437], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 20 | dur_loss: 0.3200976848602295, prior_loss: 10.630115509033203, diff_loss: 0.39140111207962036:   7%|▋         | 21/322 [00:21<05:03,  1.01s/it]tensor([-0.4570,  0.0000,  0.4301], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 21 | dur_loss: 0.3464350700378418, prior_loss: 10.036474227905273, diff_loss: 0.40117913484573364:   7%|▋         | 22/322 [00:22<04:59,  1.00it/s]tensor([-0.4664,  0.0000,  0.4369], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 22 | dur_loss: 0.3544069528579712, prior_loss: 10.329618453979492, diff_loss: 0.46077021956443787:   7%|▋         | 23/322 [00:23<04:59,  1.00s/it]tensor([-0.5139,  0.0000,  0.5079], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 23 | dur_loss: 0.353455513715744, prior_loss: 9.97656536102295, diff_loss: 0.3105608820915222:   7%|▋         | 24/322 [00:24<04:59,  1.00s/it]tensor([-0.4839,  0.0000,  0.4805], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 24 | dur_loss: 0.37497642636299133, prior_loss: 10.186963081359863, diff_loss: 0.3960503041744232:   8%|▊         | 25/322 [00:25<04:58,  1.00s/it]tensor([-0.5074,  0.0000,  0.4606], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 25 | dur_loss: 0.3392407298088074, prior_loss: 9.822948455810547, diff_loss: 0.31464454531669617:   8%|▊         | 26/322 [00:26<05:04,  1.03s/it]tensor([-0.4691,  0.0000,  0.4789], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 26 | dur_loss: 0.3378359377384186, prior_loss: 9.872941017150879, diff_loss: 0.38723304867744446:   8%|▊         | 27/322 [00:27<04:59,  1.02s/it]tensor([-0.4569,  0.0000,  0.4837], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 27 | dur_loss: 0.37442609667778015, prior_loss: 9.903304100036621, diff_loss: 0.2844755947589874:   9%|▊         | 28/322 [00:28<04:52,  1.01it/s]tensor([-0.5073,  0.0000,  0.5123], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 28 | dur_loss: 0.38109397888183594, prior_loss: 10.011693000793457, diff_loss: 0.3186664581298828:   9%|▉         | 29/322 [00:29<04:52,  1.00it/s]tensor([-0.5203,  0.0000,  0.5005], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 29 | dur_loss: 0.3962116241455078, prior_loss: 10.13452434539795, diff_loss: 0.30823415517807007:   9%|▉         | 30/322 [00:30<04:48,  1.01it/s]tensor([-0.5253,  0.0000,  0.5072], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 30 | dur_loss: 4.715350151062012, prior_loss: 9.894293785095215, diff_loss: 0.36319100856781006:  10%|▉         | 31/322 [00:31<04:47,  1.01it/s]tensor([-0.5345,  0.0000,  0.5757], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 31 | dur_loss: 0.4348190128803253, prior_loss: 9.579442024230957, diff_loss: 0.33693036437034607:  10%|▉         | 32/322 [00:32<05:04,  1.05s/it]tensor([-0.5392,  0.0000,  0.5794], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 32 | dur_loss: 0.40746423602104187, prior_loss: 9.7691011428833, diff_loss: 0.29456788301467896:  10%|█         | 33/322 [00:33<04:54,  1.02s/it]tensor([-0.6007,  0.0000,  0.5446], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 33 | dur_loss: 4.818356037139893, prior_loss: 9.133248329162598, diff_loss: 0.257139652967453:  11%|█         | 34/322 [00:34<04:48,  1.00s/it]tensor([-0.6039,  0.0000,  0.4752], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 34 | dur_loss: 0.4153174161911011, prior_loss: 9.588639259338379, diff_loss: 0.2877756953239441:  11%|█         | 35/322 [00:35<04:51,  1.01s/it]tensor([-0.5744,  0.0000,  0.5128], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 35 | dur_loss: 4.700610637664795, prior_loss: 9.531386375427246, diff_loss: 0.2706525921821594:  11%|█         | 36/322 [00:36<04:52,  1.02s/it]tensor([-0.4733,  0.0000,  0.5646], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 36 | dur_loss: 5.364706039428711, prior_loss: 9.098567008972168, diff_loss: 0.2612358629703522:  11%|█▏        | 37/322 [00:37<04:50,  1.02s/it]tensor([-0.5113,  0.0000,  0.5945], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 37 | dur_loss: 0.503689706325531, prior_loss: 9.07146167755127, diff_loss: 0.2692655622959137:  12%|█▏        | 38/322 [00:38<05:08,  1.09s/it]tensor([-0.6041,  0.0000,  0.4909], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 38 | dur_loss: 0.5506809949874878, prior_loss: 9.151838302612305, diff_loss: 0.2932361662387848:  12%|█▏        | 39/322 [00:39<04:57,  1.05s/it]tensor([-0.6364,  0.0000,  0.4969], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 39 | dur_loss: 0.5541630387306213, prior_loss: 8.839941024780273, diff_loss: 0.30975502729415894:  12%|█▏        | 40/322 [00:40<04:51,  1.04s/it]tensor([-0.6385,  0.0000,  0.6187], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 40 | dur_loss: 0.48965969681739807, prior_loss: 9.16051959991455, diff_loss: 0.26469358801841736:  13%|█▎        | 41/322 [00:41<04:50,  1.03s/it]tensor([-0.5456,  0.0000,  0.6284], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 41 | dur_loss: 0.5146114826202393, prior_loss: 8.820361137390137, diff_loss: 0.2937748432159424:  13%|█▎        | 42/322 [00:42<04:55,  1.06s/it]tensor([-0.5317,  0.0000,  0.5819], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 42 | dur_loss: 0.5140665173530579, prior_loss: 9.100502967834473, diff_loss: 0.24102066457271576:  13%|█▎        | 43/322 [00:43<04:52,  1.05s/it]tensor([-0.5946,  0.0000,  0.4940], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 43 | dur_loss: 0.5018013715744019, prior_loss: 9.159214973449707, diff_loss: 0.24002785980701447:  14%|█▎        | 44/322 [00:45<04:46,  1.03s/it]




Epoch: 1, iteration: 0 | dur_loss: 0.5456088781356812, prior_loss: 13.256754875183105, diff_loss: 1.002050757408142, monAttn_loss: 0.0, commit_loss: 0.5578035116195679, vq_loss: 0.5578035116195679:   0%|          | 1/322 [00:02<12:00,  2.24s/it]tensor([-0.0014,  0.0004,  0.0077], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 1 | dur_loss: 0.4640748202800751, prior_loss: 12.654583930969238, diff_loss: 1.0008267164230347, monAttn_loss: 0.0, commit_loss: 3.842301845550537, vq_loss: 3.842301845550537:   1%|          | 2/322 [00:02<05:23,  1.01s/it]tensor([6.5211e-05, 3.8302e-03, 1.2651e-02], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 2 | dur_loss: 0.4429880380630493, prior_loss: 12.529255867004395, diff_loss: 1.0013389587402344, monAttn_loss: 0.0, commit_loss: 3.5745959281921387, vq_loss: 3.5745959281921387:   1%|          | 3/322 [00:02<03:15,  1.63it/s]tensor([-0.0034,  0.0015,  0.0074], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 3 | dur_loss: 0.42912477254867554, prior_loss: 11.917147636413574, diff_loss: 1.0005996227264404, monAttn_loss: 0.0, commit_loss: 3.306325912475586, vq_loss: 3.306325912475586:   1%|          | 4/322 [00:02<02:18,  2.30it/s]tensor([-0.0021,  0.0031,  0.0076], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 4 | dur_loss: 0.4215274453163147, prior_loss: 11.495954513549805, diff_loss: 1.000057339668274, monAttn_loss: 0.0, commit_loss: 2.9707283973693848, vq_loss: 2.9707283973693848:   2%|▏         | 5/322 [00:02<01:43,  3.05it/s]tensor([-0.0005,  0.0031,  0.0080], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 5 | dur_loss: 0.38370513916015625, prior_loss: 11.103062629699707, diff_loss: 1.0019382238388062, monAttn_loss: 0.0, commit_loss: 3.2276687622070312, vq_loss: 3.2276687622070312:   2%|▏         | 6/322 [00:02<01:24,  3.76it/s]tensor([-0.0068,  0.0015,  0.0090], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 6 | dur_loss: 0.3677542805671692, prior_loss: 11.6593656539917, diff_loss: 0.9967502951622009, monAttn_loss: 0.0, commit_loss: 3.0841667652130127, vq_loss: 3.0841667652130127:   2%|▏         | 7/322 [00:03<01:09,  4.52it/s]tensor([-0.0071,  0.0012,  0.0114], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 7 | dur_loss: 0.39959025382995605, prior_loss: 11.711822509765625, diff_loss: 0.9924162030220032, monAttn_loss: 0.0, commit_loss: 2.7786145210266113, vq_loss: 2.7786145210266113:   2%|▏         | 8/322 [00:03<01:03,  4.94it/s]tensor([-0.0059,  0.0033,  0.0121], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 8 | dur_loss: 0.3307034969329834, prior_loss: 11.040973663330078, diff_loss: 0.9938762187957764, monAttn_loss: 0.0, commit_loss: 3.094435930252075, vq_loss: 3.094435930252075:   3%|▎         | 9/322 [00:03<00:56,  5.55it/s]tensor([-0.0127,  0.0034,  0.0161], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 9 | dur_loss: 0.3467644155025482, prior_loss: 11.561661720275879, diff_loss: 0.9922769069671631, monAttn_loss: 0.0, commit_loss: 2.8850350379943848, vq_loss: 2.8850350379943848:   3%|▎         | 10/322 [00:03<00:54,  5.73it/s]tensor([-0.0078, -0.0006,  0.0171], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 10 | dur_loss: 0.3377388119697571, prior_loss: 11.435511589050293, diff_loss: 0.9912880659103394, monAttn_loss: 0.0, commit_loss: 3.015704870223999, vq_loss: 3.015704870223999:   3%|▎         | 11/322 [00:03<00:50,  6.15it/s]tensor([-0.0302, -0.0039,  0.0229], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 11 | dur_loss: 0.3054850995540619, prior_loss: 10.377440452575684, diff_loss: 0.9861338138580322, monAttn_loss: 0.0, commit_loss: 2.7084875106811523, vq_loss: 2.7084875106811523:   4%|▎         | 12/322 [00:03<00:50,  6.11it/s]tensor([-3.1153e-02, -7.4434e-05,  2.7465e-02], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 12 | dur_loss: 0.35702672600746155, prior_loss: 11.136427879333496, diff_loss: 0.9835686087608337, monAttn_loss: 0.0, commit_loss: 3.060929536819458, vq_loss: 3.060929536819458:   4%|▍         | 13/322 [00:03<00:47,  6.48it/s]tensor([-0.0534, -0.0066,  0.0329], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 13 | dur_loss: 0.3245677649974823, prior_loss: 10.822959899902344, diff_loss: 0.9708914160728455, monAttn_loss: 0.0, commit_loss: 2.636195659637451, vq_loss: 2.636195659637451:   4%|▍         | 14/322 [00:04<00:49,  6.25it/s]tensor([-0.0512, -0.0041,  0.0415], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 14 | dur_loss: 0.28207865357398987, prior_loss: 10.746772766113281, diff_loss: 0.979004442691803, monAttn_loss: 0.0, commit_loss: 2.9594788551330566, vq_loss: 2.9594788551330566:   5%|▍         | 15/322 [00:04<00:46,  6.64it/s]tensor([-0.0524, -0.0052,  0.0440], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 15 | dur_loss: 5.337066173553467, prior_loss: 10.168092727661133, diff_loss: 0.9647449851036072, monAttn_loss: 0.0, commit_loss: 2.7460973262786865, vq_loss: 2.7460973262786865:   5%|▍         | 16/322 [00:04<00:48,  6.31it/s]tensor([-0.0602, -0.0115,  0.0514], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 16 | dur_loss: 0.31423112750053406, prior_loss: 10.136507034301758, diff_loss: 0.968245267868042, monAttn_loss: 0.0, commit_loss: 2.7339015007019043, vq_loss: 2.7339015007019043:   5%|▌         | 17/322 [00:04<00:46,  6.62it/s]tensor([-0.0742, -0.0206,  0.0651], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 17 | dur_loss: 0.30987781286239624, prior_loss: 10.325037956237793, diff_loss: 0.9630685448646545, monAttn_loss: 0.0, commit_loss: 2.695387125015259, vq_loss: 2.695387125015259:   6%|▌         | 18/322 [00:04<00:47,  6.34it/s]tensor([-0.0859, -0.0250,  0.0797], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 18 | dur_loss: 0.2981000542640686, prior_loss: 9.774100303649902, diff_loss: 0.9492258429527283, monAttn_loss: 0.0, commit_loss: 2.8834383487701416, vq_loss: 2.8834383487701416:   6%|▌         | 19/322 [00:04<00:45,  6.67it/s]tensor([-0.0632, -0.0196,  0.0640], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 19 | dur_loss: 0.27983924746513367, prior_loss: 9.631290435791016, diff_loss: 0.9627527594566345, monAttn_loss: 0.0, commit_loss: 2.798625946044922, vq_loss: 2.798625946044922:   6%|▌         | 20/322 [00:05<00:48,  6.24it/s]tensor([-0.0436, -0.0023,  0.0758], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 20 | dur_loss: 0.2828613221645355, prior_loss: 9.721749305725098, diff_loss: 0.9572277665138245, monAttn_loss: 0.0, commit_loss: 2.8295109272003174, vq_loss: 2.8295109272003174:   7%|▋         | 21/322 [00:05<00:45,  6.62it/s]tensor([-0.1026, -0.0045,  0.1139], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 21 | dur_loss: 0.32179924845695496, prior_loss: 9.581143379211426, diff_loss: 0.9398732781410217, monAttn_loss: 0.0, commit_loss: 2.568420886993408, vq_loss: 2.568420886993408:   7%|▋         | 22/322 [00:05<00:50,  5.93it/s]tensor([-0.1005, -0.0206,  0.1076], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 22 | dur_loss: 0.32572370767593384, prior_loss: 9.670927047729492, diff_loss: 0.9392438530921936, monAttn_loss: 0.0, commit_loss: 2.84946608543396, vq_loss: 2.84946608543396:   7%|▋         | 23/322 [00:05<00:47,  6.27it/s]tensor([-0.1201,  0.0131,  0.1242], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 23 | dur_loss: 0.30383041501045227, prior_loss: 9.493271827697754, diff_loss: 0.9259653687477112, monAttn_loss: 0.0, commit_loss: 2.846714973449707, vq_loss: 2.846714973449707:   7%|▋         | 24/322 [00:05<00:47,  6.32it/s]tensor([-0.1031,  0.0359,  0.1350], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 24 | dur_loss: 4.996811866760254, prior_loss: 9.025014877319336, diff_loss: 0.9383997321128845, monAttn_loss: 0.0, commit_loss: 2.7377896308898926, vq_loss: 2.7377896308898926:   8%|▊         | 25/322 [00:05<00:44,  6.63it/s]tensor([-0.1105,  0.0323,  0.1583], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 25 | dur_loss: 0.3601420223712921, prior_loss: 10.326863288879395, diff_loss: 0.9361945390701294, monAttn_loss: 0.0, commit_loss: 2.8440916538238525, vq_loss: 2.8440916538238525:   8%|▊         | 26/322 [00:06<00:50,  5.89it/s]tensor([-0.2094, -0.0060,  0.1601], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 26 | dur_loss: 0.345485121011734, prior_loss: 9.743856430053711, diff_loss: 0.9130020141601562, monAttn_loss: 0.0, commit_loss: 2.792703151702881, vq_loss: 2.792703151702881:   8%|▊         | 27/322 [00:06<00:46,  6.38it/s]tensor([-0.2056, -0.0186,  0.1566], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 27 | dur_loss: 0.35176217555999756, prior_loss: 8.908742904663086, diff_loss: 0.928280234336853, monAttn_loss: 0.0, commit_loss: 2.7144782543182373, vq_loss: 2.7144782543182373:   9%|▊         | 28/322 [00:06<00:47,  6.19it/s]tensor([-0.1754,  0.0310,  0.1911], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 28 | dur_loss: 0.30648666620254517, prior_loss: 9.460564613342285, diff_loss: 0.9172757863998413, monAttn_loss: 0.0, commit_loss: 2.711618423461914, vq_loss: 2.711618423461914:   9%|▉         | 29/322 [00:06<00:44,  6.53it/s]tensor([-0.1547,  0.0543,  0.2305], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 29 | dur_loss: 0.33720844984054565, prior_loss: 10.292972564697266, diff_loss: 0.9198276996612549, monAttn_loss: 0.0, commit_loss: 2.6168975830078125, vq_loss: 2.6168975830078125:   9%|▉         | 30/322 [00:06<00:46,  6.27it/s]tensor([-0.1850,  0.0607,  0.2708], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 30 | dur_loss: 0.3482677638530731, prior_loss: 8.291152000427246, diff_loss: 0.9009383320808411, monAttn_loss: 0.0, commit_loss: 2.5786967277526855, vq_loss: 2.5786967277526855:  10%|▉         | 31/322 [00:06<00:44,  6.58it/s]tensor([-0.2107,  0.0326,  0.2350], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 31 | dur_loss: 0.37013787031173706, prior_loss: 9.160548210144043, diff_loss: 0.9053298830986023, monAttn_loss: 0.0, commit_loss: 2.5876290798187256, vq_loss: 2.5876290798187256:  10%|▉         | 32/322 [00:07<00:47,  6.12it/s]tensor([-0.2313, -0.0077,  0.2091], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 32 | dur_loss: 0.36403653025627136, prior_loss: 9.312376022338867, diff_loss: 0.9038817286491394, monAttn_loss: 0.0, commit_loss: 2.7484989166259766, vq_loss: 2.7484989166259766:  10%|█         | 33/322 [00:07<00:44,  6.47it/s]tensor([-0.2409, -0.0081,  0.2012], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 33 | dur_loss: 0.3321709930896759, prior_loss: 9.921832084655762, diff_loss: 0.9026491045951843, monAttn_loss: 0.0, commit_loss: 2.8688502311706543, vq_loss: 2.8688502311706543:  11%|█         | 34/322 [00:07<00:47,  6.08it/s]tensor([-0.2079,  0.0106,  0.2212], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 34 | dur_loss: 0.3601492941379547, prior_loss: 8.835057258605957, diff_loss: 0.8971521258354187, monAttn_loss: 0.0, commit_loss: 2.823742151260376, vq_loss: 2.823742151260376:  11%|█         | 35/322 [00:07<00:45,  6.27it/s]tensor([-0.2232,  0.0218,  0.2701], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 35 | dur_loss: 4.622276306152344, prior_loss: 9.039743423461914, diff_loss: 0.8940467834472656, monAttn_loss: 0.0, commit_loss: 2.673776626586914, vq_loss: 2.673776626586914:  11%|█         | 36/322 [00:07<00:47,  6.04it/s]tensor([-0.2118,  0.0575,  0.3121], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 36 | dur_loss: 0.376140296459198, prior_loss: 8.877975463867188, diff_loss: 0.8847613334655762, monAttn_loss: 0.0, commit_loss: 2.723234176635742, vq_loss: 2.723234176635742:  11%|█▏        | 37/322 [00:07<00:43,  6.52it/s]tensor([-0.1801,  0.0475,  0.2873], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 37 | dur_loss: 0.40005752444267273, prior_loss: 8.858004570007324, diff_loss: 0.9067692160606384, monAttn_loss: 0.0, commit_loss: 2.7463161945343018, vq_loss: 2.7463161945343018:  12%|█▏        | 38/322 [00:07<00:47,  6.01it/s]tensor([-0.2307,  0.0251,  0.2973], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 38 | dur_loss: 0.3752996623516083, prior_loss: 9.165450096130371, diff_loss: 0.9032790064811707, monAttn_loss: 0.0, commit_loss: 2.4833121299743652, vq_loss: 2.4833121299743652:  12%|█▏        | 39/322 [00:08<00:44,  6.34it/s]tensor([-0.3266, -0.0113,  0.2925], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 39 | dur_loss: 0.40157651901245117, prior_loss: 9.008584976196289, diff_loss: 0.878481924533844, monAttn_loss: 0.0, commit_loss: 2.9258198738098145, vq_loss: 2.9258198738098145:  12%|█▏        | 40/322 [00:08<00:47,  5.97it/s]tensor([-0.2751, -0.0147,  0.2921], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 40 | dur_loss: 5.315330982208252, prior_loss: 8.770915985107422, diff_loss: 0.8981723189353943, monAttn_loss: 0.0, commit_loss: 2.8994321823120117, vq_loss: 2.8994321823120117:  13%|█▎        | 41/322 [00:08<00:43,  6.47it/s]tensor([-0.2531,  0.0105,  0.2964], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 41 | dur_loss: 0.41252216696739197, prior_loss: 8.882216453552246, diff_loss: 0.8843929171562195, monAttn_loss: 0.0, commit_loss: 2.6469333171844482, vq_loss: 2.6469333171844482:  13%|█▎        | 42/322 [00:08<00:46,  5.99it/s]tensor([-0.2779,  0.0618,  0.3734], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 42 | dur_loss: 0.40227624773979187, prior_loss: 8.40711784362793, diff_loss: 0.8665319681167603, monAttn_loss: 0.0, commit_loss: 2.5532987117767334, vq_loss: 2.5532987117767334:  13%|█▎        | 43/322 [00:08<00:43,  6.38it/s]tensor([-0.2719,  0.0160,  0.3349], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 43 | dur_loss: 4.909321308135986, prior_loss: 8.425559043884277, diff_loss: 0.8842135667800903, monAttn_loss: 0.0, commit_loss: 2.6637017726898193, vq_loss: 2.6637017726898193:  14%|█▎        | 44/322 [00:08<00:46,  5.99it/s]tensor([-0.2899,  0.0203,  0.3490], device='cuda:0',
       grad_fn=<SqueezeBackward3>)
Epoch: 1, iteration: 44 | dur_loss: 0.39421743154525757, prior_loss: 8.841570854187012, diff_loss: 0.8641246557235718, monAttn_loss: 0.0, commit_loss: 2.6137917041778564, vq_loss: 2.6137917041778564:  14%|█▍        | 45/322 [00:09<00:43,  6.37it/s]tensor([-0.2848, -0.0103,  0.3164], device='cuda:0',
       grad_fn=<SqueezeBackward3>)



(ddpm) rosen@rosen:~/Project/DiT$ torchrun --nnodes=1 --nproc_per_node=1 train.py --model DiT-XL/2 --data-path /hdd/ILSVRC/Data/CLS-LOC/train
Starting rank=0, seed=0, world_size=1.
[2025-01-12 10:17:31] Experiment directory created at results/020-DiT-XL-2
[2025-01-12 10:17:38] DiT Parameters: 675,111,184
[2025-01-12 10:17:40] Dataset contains 1,281,167 images (/hdd/ILSVRC/Data/CLS-LOC/train)
[2025-01-12 10:17:40] Training for 1400 epochs...
[2025-01-12 10:17:40] Beginning epoch 0...
[2025-01-12 10:18:11] (step=0000100) Train Loss: 0.3608, Train Steps/Sec: 3.26
[2025-01-12 10:18:40] (step=0000200) Train Loss: 0.2211, Train Steps/Sec: 3.42
[2025-01-12 10:19:10] (step=0000300) Train Loss: 0.2163, Train Steps/Sec: 3.37
[2025-01-12 10:19:40] (step=0000400) Train Loss: 0.1997, Train Steps/Sec: 3.31
[2025-01-12 10:20:11] (step=0000500) Train Loss: 0.2051, Train Steps/Sec: 3.24
[2025-01-12 10:20:41] (step=0000600) Train Loss: 0.1907, Train Steps/Sec: 3.28
[2025-01-12 10:21:13] (step=0000700) Train Loss: 0.1854, Train Steps/Sec: 3.15




train_styleEnhanceTTS, unet
Epoch: 1, iteration: 0 | dur_loss: 0.510028064250946, prior_loss: 12.809596061706543, diff_loss: 1.1240019798278809, :   0%|          | 1/322 [00:01<10:20,  1.93s/it]tensor(-0.0339, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 1 | dur_loss: 0.4867549538612366, prior_loss: 12.1239013671875, diff_loss: 1.1333153247833252, :   1%|          | 2/322 [00:02<04:58,  1.07it/s]tensor(0.0555, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 2 | dur_loss: 0.45611608028411865, prior_loss: 11.871773719787598, diff_loss: 0.9998469352722168, :   1%|          | 3/322 [00:02<03:14,  1.64it/s]tensor(0.0415, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 3 | dur_loss: 0.41279181838035583, prior_loss: 13.105049133300781, diff_loss: 0.9804974794387817, :   1%|          | 4/322 [00:02<02:26,  2.17it/s]tensor(-0.0414, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 4 | dur_loss: 0.4005456268787384, prior_loss: 11.714046478271484, diff_loss: 0.9508800506591797, :   2%|▏         | 5/322 [00:02<01:59,  2.65it/s]tensor(-0.0547, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 5 | dur_loss: 0.3667316734790802, prior_loss: 11.23645305633545, diff_loss: 0.9132950305938721, :   2%|▏         | 6/322 [00:03<01:43,  3.07it/s]tensor(-0.0050, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 6 | dur_loss: 0.37447836995124817, prior_loss: 11.20418930053711, diff_loss: 0.878051221370697, :   2%|▏         | 7/322 [00:03<01:31,  3.45it/s]tensor(0.0330, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 7 | dur_loss: 5.323976516723633, prior_loss: 11.285553932189941, diff_loss: 0.822041392326355, :   2%|▏         | 8/322 [00:03<01:24,  3.70it/s]tensor(0.0424, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 8 | dur_loss: 0.36380529403686523, prior_loss: 11.361212730407715, diff_loss: 0.8075239062309265, :   3%|▎         | 9/322 [00:03<01:19,  3.94it/s]tensor(0.0246, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 9 | dur_loss: 0.3512573540210724, prior_loss: 10.189010620117188, diff_loss: 0.7710191607475281, :   3%|▎         | 10/322 [00:03<01:15,  4.11it/s]tensor(-0.0083, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 10 | dur_loss: 0.3350590765476227, prior_loss: 10.679031372070312, diff_loss: 0.7047964334487915, :   3%|▎         | 11/322 [00:04<01:13,  4.23it/s]tensor(-0.0070, device='cuda:0', grad_fn=<MeanBackward0>)
...
Epoch: 1, iteration: 88 | dur_loss: 0.4883386492729187, prior_loss: 6.912626266479492, diff_loss: 0.18900518119335175, :  28%|██▊       | 89/322 [00:23<00:54,  4.24it/s]tensor(0.0283, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 89 | dur_loss: 5.748055458068848, prior_loss: 6.966148376464844, diff_loss: 0.19557088613510132, :  28%|██▊       | 90/322 [00:23<00:53,  4.31it/s]tensor(0.0533, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 90 | dur_loss: 0.45737192034721375, prior_loss: 6.331953525543213, diff_loss: 0.23349802196025848, :  28%|██▊       | 91/322 [00:23<00:53,  4.36it/s]tensor(0.0243, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 91 | dur_loss: 0.4779963791370392, prior_loss: 6.9363884925842285, diff_loss: 0.1378791630268097, :  29%|██▊       | 92/322 [00:23<00:53,  4.34it/s]tensor(-0.0368, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 92 | dur_loss: 0.4785183370113373, prior_loss: 6.170170783996582, diff_loss: 0.2555595338344574, :  29%|██▉       | 93/322 [00:23<00:52,  4.37it/s]tensor(-0.0664, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 93 | dur_loss: 0.5120822787284851, prior_loss: 6.624711036682129, diff_loss: 0.2973136603832245, :  29%|██▉       | 94/322 [00:24<00:51,  4.41it/s]tensor(-0.0225, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 94 | dur_loss: 5.14440393447876, prior_loss: 6.01803731918335, diff_loss: 0.18029019236564636, :  30%|██▉       | 95/322 [00:24<00:51,  4.38it/s]tensor(0.0312, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 95 | dur_loss: 0.46842876076698303, prior_loss: 6.3148193359375, diff_loss: 0.2398798167705536, :  30%|██▉       | 96/322 [00:24<00:51,  4.41it/s]tensor(0.0408, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 96 | dur_loss: 0.47308671474456787, prior_loss: 6.400583267211914, diff_loss: 0.18989297747612, :  30%|███       | 97/322 [00:24<00:50,  4.44it/s]tensor(0.0161, device='cuda:0', grad_fn=<MeanBackward0>)
Epoch: 1, iteration: 97 | dur_loss: 0.42052119970321655, prior_loss: 6.903224945068359, diff_loss: 0.2497517317533493, :  30%|███       | 98/322 [00:25<00:50,  4.43it/s]tensor(-0.0111, device='cuda:0', grad_fn=<MeanBackward0>)
Epoc
